<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Interactive Tech Map</title>

  <!-- Leaflet CSS -->
  <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />

  <style>
    * { box-sizing: border-box; }
    html, body { height: 100%; margin: 0; }
    body { font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif; background:#0b1020; color:#e9ecff; }

    /* Right panel */
    #panel {
      position: fixed; top: 0; right: 0; bottom: 0; width: 360px;
      background: radial-gradient(1200px 800px at 100% 0%, #141a3c 0%, #0f1530 45%, #0b1020 100%);
      border-left: 1px solid #20285a;
      padding: 14px 14px 64px;
      display: flex; flex-direction: column; gap: 12px;
      box-shadow: inset 0 1px 0 rgba(255,255,255,.03);
      overflow: auto; z-index: 500;
    }

    /* Map fills space left of the panel */
    #map {
      position: absolute; top: 0; left: 0; bottom: 0; right: 360px;
      min-height: 520px; background: #0b1020; /* clean backdrop (no tiles) */
    }

    /* On-map legend (kept for look; shows min/max numbers when data present) */
    .map-legend {
      position: absolute; left: 12px; bottom: 12px; z-index: 600;
      background: #0f1530cc; backdrop-filter: blur(4px);
      border: 1px solid #2b3262; border-radius: 10px;
      padding: 10px 12px; box-shadow: 0 6px 18px rgba(0,0,0,.3);
    }
    .legend-labels { display:flex; justify-content: space-between; gap: 10px; font-size:.8rem; opacity:.9; color:#e9ecff; }
    #legendCanvas { display:block; margin-bottom:6px; border-radius: 6px;
      background: linear-gradient(90deg,#d73027,#f9784a,#fcb96e,#fee8a8,#e5f5ff,#a8d4f0,#6aa9db,#3c6db4);
    }

    /* Panel header with sticky dropdown (mobile-friendly) */
    .panel-header {
      position: sticky; top: 0; z-index: 2;
      display: flex; justify-content: flex-end; align-items: center;
      padding-bottom: 6px; margin-bottom: 6px;
      background: linear-gradient(180deg, rgba(10,15,32,.9), rgba(10,15,32,0));
      backdrop-filter: blur(3px);
    }
    #metricSelect {
      background: #0f1530; color: #e9ecff;
      border: 1px solid #2b3262; border-radius: 10px;
      padding: 10px 12px; min-width: 210px; font-size: 0.95rem;
    }

    /* Stats + chart cards */
    .stats-card, .chart-card {
      border: 1px solid #2b3262; border-radius: 12px; background:#0e1330;
      box-shadow: 0 6px 20px rgba(0,0,0,.25);
    }
    .stats-card { padding: 10px 12px; }
    .stats-row { display:flex; justify-content: space-between; margin: 6px 0; font-size: .95rem; }
    .stats-row span { opacity: .85; }

    .chart-card { padding: 10px 12px; min-height: 260px; display:flex; flex-direction: column; }

    .credit { position: absolute; right: 14px; bottom: 10px; opacity: .85; font-size: .9rem; }
    .leaflet-interactive { transition: all 180ms ease; }

    /* Mobile: panel under map, bigger tap areas */
    @media (max-width: 980px) {
      #panel { position: static; width: auto; border-left: none; border-top: 1px solid #20285a; padding-bottom: 90px; }
      #map { position: relative; right: 0; height: 60vh; min-height: 360px; }
      .map-legend { left: 50%; transform: translateX(-50%); }
      #metricSelect { min-width: 100%; }
      .credit { position: static; text-align: right; margin-top: 10px; }
    }
  </style>
</head>
<body>

  <!-- Map -->
  <div id="map">
    <div id="map-legend" class="map-legend">
      <canvas id="legendCanvas" width="220" height="12" aria-hidden="true"></canvas>
      <div class="legend-labels"><span id="legendMin">Low</span><span id="legendMax">High</span></div>
    </div>
  </div>

  <!-- Right panel -->
  <aside id="panel">
    <div class="panel-header">
      <select id="metricSelect" aria-label="Choose metric">
        <option value="openings_rate">Job Openings Rate (JOLTS, %)</option>
        <option value="swdev_wage">Software Dev Annual Mean Wage (OEWS)</option>
      </select>
    </div>

    <div class="stats-card">
      <div class="stats-row"><span>Metric:</span><strong id="statMetric">—</strong></div>
      <div class="stats-row"><span>U.S. Avg:</span><strong id="statAvg">—</strong></div>
      <div class="stats-row"><span>Max (State):</span><strong id="statMax">—</strong></div>
      <div class="stats-row"><span>Min (State):</span><strong id="statMin">—</strong></div>
    </div>

    <div class="chart-card">
      <canvas id="rankChart"></canvas>
    </div>

    <div class="credit">Created by <strong>Eric Holt</strong></div>
  </aside>

  <!-- Libraries -->
  <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/topojson-client@3"></script>
  <script src="https://cdn.jsdelivr.net/npm/chroma-js@2.4.2/dist/chroma.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>

  <!-- App -->
  <script src="app.js?v=bls1"></script>
</body>
</html>
